<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />

		<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame
		Remove this if you use the .htaccess -->
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

		<title>Caret tests</title>
		<meta name="viewport" content="width=device-width initial-scale=1.0" />
		<script src="../kernelTest.js"></script>
		<script src="../zepto.min.js"></script>
		<link rel="stylesheet" type="text/css" href="../style.css">

		<style type="text/css">
		ol li{
			margin:5px;
		}
		iframe {
        border: 1px solid black;
        width: 400px;
    }

		</style>

	</head>

	<body>
		<div>
			<!-- Here is the Menu -->
			<div class="par">≡</div>
			<div class="todolist">
				<h1>测试内容</h1>
				<hr>
				<p><span>请勾选测试通过的选项：</span></p>
				<ol>
					<li>
						<label for="task1">caret-blink-during-forward-delete</label>
						<input  class="checkbox" type="checkbox" id="task1" data-pass="caret-blink-during-forward-delete">
					</li>
					<li>
						<label for="task2">caretScrolling</label>
						<input  class="checkbox" type="checkbox" id="task2" data-pass="caretScrolling">
					</li>
					<li>
						<label for="task3">caret-in-compositing-frame</label>
						<input  class="checkbox" type="checkbox" id="task3" data-pass="caret-in-compositing-frame">
					</li>
				</ol>
				<p><span>请综合评价测试是否通过或跳过：</span></p>
				<div style="padding-left: 20px;">
					<div>
						<textarea class="ktest-comments" placeholder="在此处填写评语，选填"></textarea>
					</div>
					<a id="ktest-pass" class="ktest-btn result">pass</a>
					<a id="ktest-fail" class="ktest-btn result">fail</a>
					<a id="ktest-next" class="ktest-btn">next</a>
				</div>
			</div><!-- Menu end -->
			
			<!-- place your test case HTML content here -->
			<h1>Caret tests</h1>
			<hr>

			<div class='case'>
				<div class='describe'>
					<p style="background-color:skyblue; padding:3px;"><span>Decription:</span>This tests forward deleting 200 characters with 10ms intervals.【1】</p>
					<p style="background-color:palegreen; padding:3px;"><b>TEST PASS:</b> 
						The caret shown below should not blink while the characters are being deleted.
					</p>
					<p style="background-color:#FF3300; padding:3px;"><b>TEST FAIL:</b>  
					</p>
				</div>
				<div id="test" contenteditable></div>
			</div><!-- .case end -->

			<br><br><hr>
			<div class='case'>
				<div class='describe'>
					<p style="background-color:skyblue; padding:3px;"><span>Decription:</span>Manual test for fix for <a href="rdar://problem/3690705">rdar://problem/3690705</a> "caret does not move when scrolling overflow: auto editable area"【2】</p>
					<p><b>STEPS TO TEST:</b>
						Click inside the block below, a caret should appear.  Grab the block's scroll handle and scroll down.  The caret blinks, try to grab the scroll handle while the caret is visible.  The caret should scroll and disappear when it reaches the block's border.

					</p>
					<p style="background-color:palegreen; padding:3px;"><b>TEST PASS:</b> 
						The caret blinks correctly.
					</p>
					<p style="background-color:#FF3300; padding:3px;"><b>TEST FAIL:</b>  
						If it doesn't pass, it fails.
					</p>
				</div>
				<div contentEditable style="border: 1px solid blue; height: 100px; overflow:scroll;">
					one<br>
					two<br>
					three<br>
					four<br>
					five<br>
					six<br>
					seven<br>
					eight<br>
				</div>
			</div><!-- .case end -->

			<br><br><hr>
			<div class='case'>
				<div class='describe'>
					<p style="background-color:skyblue; padding:3px;"><span>Decription:</span>caret-in-compositing-frame【3】</p>
					<p style="background-color:palegreen; padding:3px;"><b>TEST PASS:</b> 
						The caret should blink correctly when editing the paragraph in the frame.
					</p>
					<p style="background-color:#FF3300; padding:3px;"><b>TEST FAIL:</b>  
						If it doesn't pass, it fails.
					</p>
				</div>
				<iframe src="../resources/editable-compositing-subframe.html" scrolling="no"></iframe>

			</div><!-- .case end -->
			<br><br>


			
		<script>
			// place your test case JS code here
			var test = document.getElementById('test');
			var text = '';
			for (var i = 0; i < 200; i++)
			    text += 'a';
			test.textContent = text;

			test.focus();
			getSelection().collapse(test, 0);
			for (var i = 0; i < 200; i++)
			    setTimeout(function () {document.execCommand('ForwardDelete', false, null);}, i * 10);


			/********************/ 
			kTest.init({
				onResult : function(status, comments){
					if (status === "passed" || status === "failed"){
						$(".result").hide();
					}

					$(".ktest-comments").val(comments);
				}
			});

			$(".ktest-btn").bind("click", function(){
				var str = '';
				$('.checkbox').each(function(){
					if($(this).attr("checked") == true)
						str+='<span class="passed">'+$(this).data("pass")+"</span>;";
					else
						str+='<span class="failed">'+$(this).data("pass")+"</span>;"
				})
				var comments = str + $(".ktest-comments").val();
				var id =this.id;
				switch(id){
					case "ktest-pass": kTest.pass(comments); break;
					case "ktest-fail": kTest.fail(comments); break;
					case "ktest-next": kTest.next(comments); break;
				}
			});
			$('.par').on("click",function(){
				if($('.par').html() =='≡')
					$('.par').html('×');
				else
					$('.par').html('≡');
				$('.todolist').toggle();
				$('.checkbox').each(function(index){
					console.log(this.data('note'));
				});
			});
			$('.todolist').toggle();
		</script>
	</body>
</html>
